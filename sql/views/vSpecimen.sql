create view vSpecimen as
select s.action_on,s.action_by,
    s.specimen_id,
    s.path_report_id,
    p.event_id,
    to_char(e.event_date,'yyyy-mm-dd') as event_date,
    p.case_no,
    p.lab_code,
    p.no_q_form,
    p.q_form_incomplete,
    e.person_id,
    s.path_polyp_loc,
    s.polyp_num,
    s.discrepnote,
    s.container,
    s.fragment,
    s.other_dx_specify,
    s.site_location_cm,
    s.site_desc,
    s.size_mm,
    s.flat_polyp,
    s.anallevel,
    s.flg_no_path_spec,
    s.ptype_carcinoid,
    s.ptype_ganglio,
    s.ptype_hamart,
    s.ptype_hp,
    s.ptype_inflam,
    s.ptype_juvenile,
    s.ptype_lelomyoma,
    s.ptype_lipoma,
    s.ptype_mp,
    s.ptype_norm_muc,
    s.ptype_not_polyp,
    s.ptype_other,
    s.ptype_pautzjeg,
    s.ptype_sa,
    s.ptype_ssp,
    s.ptype_mixed,
    s.ptype_ta,
    s.ptype_tva,
    s.ptype_va,
    s.flg_dx,
    s.flg_no_discrep,
    s.flg_no_q_spec,
    s.flg_num_polyps,
    s.flg_site_discrep,
    s.flg_site_uncert,
    s.flg_path_sites,
    s.flg_review,
    s.hgd,
    s.ibd_ibd,
    s.ibd_actcol,
    s.ibd_chroncol,
    s.ibd_coloth,
    s.ibd_inactcol,
    s.ibd_lgdysp,
    s.n_intra_ca,
    s.n_inv_ca,
    s.n_cancer,
    s.ptype_fibroblast,
    s.ptype_lymphoid,
    s.flg_noqdata,
    s.flg_assump,
    s.flg_multis,
    s.flg_multisites,
    s.flg_residual,
    s.flg_assump_numpolyps,
    s.flg_dx_size,
    s.flg_dx_site,
    s.flg_dx_multis,
    s.specimen_type,
    s.notes,
    s.t_class,
    s.n_class,
    s.date_of_export,
    s.y_prefix,
    s.record_complete,
    s.flg_size_discrep,
    s.sas_key_id
from specimen s left outer join path_report p on
    s.path_report_id = p.path_report_id
    join event e on p.event_id = e.event_id;
grant select on vSpecimen to NHCR2_rc;
